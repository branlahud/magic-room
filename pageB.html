<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Player</title>
  <style>
    body { margin: 0; background: black; overflow: hidden; }
    video, iframe { width: 100vw; height: 100vh; object-fit: cover; }
  </style>
</head>
<body>

<!-- Background Music -->
<audio id="bgm1" src="BGM1.mp3" loop></audio>
<audio id="bgm2" src="BGM2.mp3" loop></audio>

<!-- Videos -->
<video id="video1" src="video1.mp4" style="display:none"></video>
<video id="video2" src="video2.mp4" style="display:none"></video>
<video id="video3" src="video3.mp4" style="display:none"></video>

<!-- YouTube iframe -->
<div id="youtubeContainer" style="display:none;">
  <iframe id="youtubeVideo" src="" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
</div>

<script>
  const socket = new WebSocket(`wss://${location.host}`);
  const bgm1 = document.getElementById('bgm1');
  const bgm2 = document.getElementById('bgm2');
  let bgmToggle = true;

  // Loop two audios alternately
  function startBGM() {
    bgm1.play();
    bgm1.onended = () => {
      bgm2.play();
    };
    bgm2.onended = () => {
      bgm1.play();
    };
  }

  startBGM();

  socket.onmessage = function(event) {
    const code = event.data;
    bgm1.pause();
    bgm2.pause();
    if (code === "5920") {
      playVideo("video1");
    } else if (code === "1346799352") {
      playVideo("video2");
    } else if (code === "288") {
      playVideo("video3");
    } else if (code === "15100") {
      playYouTube();
    }
  };

  function playVideo(videoId) {
    const video = document.getElementById(videoId);
    video.style.display = "block";
    video.play();
    video.onended = function() {
      video.style.display = "none";
      startBGM();
    };
  }

  function playYouTube() {
    const youtube = document.getElementById('youtubeVideo');
    document.getElementById('youtubeContainer').style.display = "block";
    youtube.src = "https://www.youtube.com/embed/2wW5CpQDSfU?autoplay=1&controls=0&rel=0&modestbranding=1";
    setTimeout(() => {
      document.getElementById('youtubeContainer').style.display = "none";
      youtube.src = "";
      startBGM();
    }, 200000); // 200 seconds (~3 minutes), or adjust based on video length
  }
</script>

</body>
</html>
